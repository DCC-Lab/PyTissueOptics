
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dcclab.github.io/PyTissueOptics/api/scene/">
      
      
        <link rel="prev" href="../rayscattering/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Scene - PyTissueOptics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scene-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyTissueOptics" class="md-header__button md-logo" aria-label="PyTissueOptics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyTissueOptics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Scene
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyTissueOptics" class="md-nav__button md-logo" aria-label="PyTissueOptics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyTissueOptics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rayscattering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RayScattering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Scene
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Scene
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene" class="md-nav__link">
    <span class="md-ellipsis">
      scene
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cuboid" class="md-nav__link">
    <span class="md-ellipsis">
      Cuboid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cuboid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cuboid.stack" class="md-nav__link">
    <span class="md-ellipsis">
      stack
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cylinder" class="md-nav__link">
    <span class="md-ellipsis">
      Cylinder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cylinder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cylinder.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Ellipsoid" class="md-nav__link">
    <span class="md-ellipsis">
      Ellipsoid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ellipsoid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Ellipsoid.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Loader" class="md-nav__link">
    <span class="md-ellipsis">
      Loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger" class="md-nav__link">
    <span class="md-ellipsis">
      Logger
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getRawDataPoints" class="md-nav__link">
    <span class="md-ellipsis">
      getRawDataPoints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getSeenSolidLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getSeenSolidLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getSeenSurfaceLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getSeenSurfaceLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getStoredSolidLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getStoredSolidLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getStoredSurfaceLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getStoredSurfaceLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.logDataPointArray" class="md-nav__link">
    <span class="md-ellipsis">
      logDataPointArray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.logPointArray" class="md-nav__link">
    <span class="md-ellipsis">
      logPointArray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.logSegmentArray" class="md-nav__link">
    <span class="md-ellipsis">
      logSegmentArray
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Scene" class="md-nav__link">
    <span class="md-ellipsis">
      Scene
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Sphere" class="md-nav__link">
    <span class="md-ellipsis">
      Sphere
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sphere">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Sphere.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.SymmetricLens" class="md-nav__link">
    <span class="md-ellipsis">
      SymmetricLens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.ThickLens" class="md-nav__link">
    <span class="md-ellipsis">
      ThickLens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ThickLens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.ThickLens.focalLength" class="md-nav__link">
    <span class="md-ellipsis">
      focalLength
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Vector" class="md-nav__link">
    <span class="md-ellipsis">
      Vector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Vector.rotateAround" class="md-nav__link">
    <span class="md-ellipsis">
      rotateAround
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene" class="md-nav__link">
    <span class="md-ellipsis">
      scene
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cuboid" class="md-nav__link">
    <span class="md-ellipsis">
      Cuboid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cuboid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cuboid.stack" class="md-nav__link">
    <span class="md-ellipsis">
      stack
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cylinder" class="md-nav__link">
    <span class="md-ellipsis">
      Cylinder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cylinder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Cylinder.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Ellipsoid" class="md-nav__link">
    <span class="md-ellipsis">
      Ellipsoid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ellipsoid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Ellipsoid.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Loader" class="md-nav__link">
    <span class="md-ellipsis">
      Loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger" class="md-nav__link">
    <span class="md-ellipsis">
      Logger
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getRawDataPoints" class="md-nav__link">
    <span class="md-ellipsis">
      getRawDataPoints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getSeenSolidLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getSeenSolidLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getSeenSurfaceLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getSeenSurfaceLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getStoredSolidLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getStoredSolidLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.getStoredSurfaceLabels" class="md-nav__link">
    <span class="md-ellipsis">
      getStoredSurfaceLabels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.logDataPointArray" class="md-nav__link">
    <span class="md-ellipsis">
      logDataPointArray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.logPointArray" class="md-nav__link">
    <span class="md-ellipsis">
      logPointArray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Logger.logSegmentArray" class="md-nav__link">
    <span class="md-ellipsis">
      logSegmentArray
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Scene" class="md-nav__link">
    <span class="md-ellipsis">
      Scene
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Sphere" class="md-nav__link">
    <span class="md-ellipsis">
      Sphere
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sphere">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Sphere.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.SymmetricLens" class="md-nav__link">
    <span class="md-ellipsis">
      SymmetricLens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.ThickLens" class="md-nav__link">
    <span class="md-ellipsis">
      ThickLens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ThickLens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.ThickLens.focalLength" class="md-nav__link">
    <span class="md-ellipsis">
      focalLength
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Vector" class="md-nav__link">
    <span class="md-ellipsis">
      Vector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytissueoptics.scene.Vector.rotateAround" class="md-nav__link">
    <span class="md-ellipsis">
      rotateAround
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="scene-module">Scene Module</h1>


<div class="doc doc-object doc-module">



<a id="pytissueoptics.scene"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Cuboid" class="doc doc-heading">
            <code>Cuboid</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pytissueoptics.scene.solids.solid.Solid">Solid</span></code></p>


        <p>Also known as the Right Rectangular Prism, the Cuboid is defined by its
width (a, b, c) in each axis (x, y, z) respectively.</p>
<p>The position refers to the vector from global origin to its centroid.
The generated mesh will be divided into the following subgroups:
Left (-x), Right (+x), Bottom (-y), Top (+y), Front (-z), Back (+z).</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/solids/cuboid.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Cuboid</span><span class="p">(</span><span class="n">Solid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Also known as the Right Rectangular Prism, the Cuboid is defined by its</span>
<span class="sd">    width (a, b, c) in each axis (x, y, z) respectively.</span>

<span class="sd">    The position refers to the vector from global origin to its centroid.</span>
<span class="sd">    The generated mesh will be divided into the following subgroups:</span>
<span class="sd">    Left (-x), Right (+x), Bottom (-y), Top (+y), Front (-z), Back (+z).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">vertices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">surfaces</span><span class="p">:</span> <span class="n">SurfaceCollection</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cuboid&quot;</span><span class="p">,</span>
        <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
        <span class="n">labelOverride</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">]</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">surfaces</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">labelOverride</span><span class="o">=</span><span class="n">labelOverride</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeTriangleMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;front&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;back&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeQuadMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Quad</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Quad</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Quad</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Quad</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;front&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Quad</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;back&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Quad</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Cuboid&quot;</span><span class="p">,</span> <span class="n">onSurface</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">stackLabel</span><span class="o">=</span><span class="s2">&quot;CuboidStack&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Cuboid&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic implementation for stacking cuboids along an axis.</span>

<span class="sd">        For example, stacking on &#39;top&#39; will move the other cuboid on top of this cuboid. They will now share</span>
<span class="sd">         the same mesh at the interface and inside/outside materials at the interface will be properly defined.</span>
<span class="sd">         This will return a new cuboid that represents the stack, with a new &#39;interface&lt;i&gt;&#39; surface group.</span>

<span class="sd">        Limitations:</span>
<span class="sd">            - Requires cuboids with the same shape except along the stack axis.</span>
<span class="sd">            - Cannot stack another stack unless it is along its stacked axis (ill-defined interface material).</span>
<span class="sd">            - Expected behavior not guaranteed for pre-rotated cuboids.</span>
<span class="sd">            - Stacked cuboids will lose reference to their initial stack surface (not a closed solid anymore).</span>
<span class="sd">                Use the returned cuboid stack.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stacker</span> <span class="o">=</span> <span class="n">CuboidStacker</span><span class="p">()</span>
        <span class="n">stackResult</span> <span class="o">=</span> <span class="n">stacker</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">onCuboid</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">otherCuboid</span><span class="o">=</span><span class="n">other</span><span class="p">,</span> <span class="n">onSurface</span><span class="o">=</span><span class="n">onSurface</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Cuboid</span><span class="o">.</span><span class="n">_fromStackResult</span><span class="p">(</span><span class="n">stackResult</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">stackLabel</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fromStackResult</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">stackResult</span><span class="p">:</span> <span class="n">StackResult</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Cuboid&quot;</span><span class="p">:</span>
        <span class="c1"># subtracting stackCentroid from all vertices because solid creation will translate back to position.</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">stackResult</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">vertex</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">stackResult</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>

        <span class="n">cuboid</span> <span class="o">=</span> <span class="n">Cuboid</span><span class="p">(</span>
            <span class="o">*</span><span class="n">stackResult</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="n">stackResult</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
            <span class="n">vertices</span><span class="o">=</span><span class="n">stackResult</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span>
            <span class="n">surfaces</span><span class="o">=</span><span class="n">stackResult</span><span class="o">.</span><span class="n">surfaces</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">primitive</span><span class="o">=</span><span class="n">stackResult</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span>
            <span class="n">labelOverride</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cuboid</span><span class="o">.</span><span class="n">_layerLabels</span> <span class="o">=</span> <span class="n">stackResult</span><span class="o">.</span><span class="n">layerLabels</span>
        <span class="k">return</span> <span class="n">cuboid</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">vertices</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">relativeVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">relativeVertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applyInverseRotation</span><span class="p">(</span><span class="n">relativeVertices</span><span class="p">)</span>

        <span class="n">relativeVertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">vertex</span><span class="o">.</span><span class="n">array</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">relativeVertices</span><span class="p">])</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">relativeVertices</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
            <span class="c1"># At this point, all vertices are contained in the bounding box of the stack.</span>
            <span class="c1"># We just need to make sure they are contained in a single layer.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aSingleLayerContains</span><span class="p">(</span><span class="n">relativeVertices</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_aSingleLayerContains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relativeVertices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">layerLabel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layerLabels</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLayerBBox</span><span class="p">(</span><span class="n">layerLabel</span><span class="p">)</span>
            <span class="n">bboxShape</span> <span class="o">=</span> <span class="p">[</span><span class="n">bbox</span><span class="o">.</span><span class="n">xWidth</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">yWidth</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">zWidth</span><span class="p">]</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">bboxShape</span><span class="p">]</span>
            <span class="n">layerOffset</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
            <span class="n">layerRelativeVertices</span> <span class="o">=</span> <span class="n">relativeVertices</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">layerOffset</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">layerRelativeVertices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getLayerBBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layerLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BoundingBox</span><span class="p">:</span>
        <span class="n">polygons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLayerPolygons</span><span class="p">(</span><span class="n">layerLabel</span><span class="p">)</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">BoundingBox</span><span class="o">.</span><span class="n">fromPolygons</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getLayerPolygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layerLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Polygon</span><span class="p">]:</span>
        <span class="n">layerSurfaceLabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layerLabels</span><span class="p">[</span><span class="n">layerLabel</span><span class="p">]</span>
        <span class="n">polygons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">surfaceLabel</span> <span class="ow">in</span> <span class="n">layerSurfaceLabels</span><span class="p">:</span>
            <span class="n">polygons</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">polygons</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_geometryParams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">baseHash</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">baseHash</span>

        <span class="n">materials</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">surfaceLabel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surfaceLabels</span><span class="p">:</span>
            <span class="n">material</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">insideEnvironment</span><span class="o">.</span><span class="n">material</span>
            <span class="n">materials</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">material</span><span class="p">)</span>
        <span class="n">materialsHash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="n">baseHash</span><span class="p">,</span> <span class="n">materialsHash</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Cuboid.stack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stack</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">onSurface</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">stackLabel</span><span class="o">=</span><span class="s1">&#39;CuboidStack&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Basic implementation for stacking cuboids along an axis.</p>
<p>For example, stacking on 'top' will move the other cuboid on top of this cuboid. They will now share
 the same mesh at the interface and inside/outside materials at the interface will be properly defined.
 This will return a new cuboid that represents the stack, with a new 'interface<i>' surface group.</p>


<details class="limitations" open>
  <summary>Limitations</summary>
  <ul>
<li>Requires cuboids with the same shape except along the stack axis.</li>
<li>Cannot stack another stack unless it is along its stacked axis (ill-defined interface material).</li>
<li>Expected behavior not guaranteed for pre-rotated cuboids.</li>
<li>Stacked cuboids will lose reference to their initial stack surface (not a closed solid anymore).
    Use the returned cuboid stack.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/solids/cuboid.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Cuboid&quot;</span><span class="p">,</span> <span class="n">onSurface</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">stackLabel</span><span class="o">=</span><span class="s2">&quot;CuboidStack&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Cuboid&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Basic implementation for stacking cuboids along an axis.</span>

<span class="sd">    For example, stacking on &#39;top&#39; will move the other cuboid on top of this cuboid. They will now share</span>
<span class="sd">     the same mesh at the interface and inside/outside materials at the interface will be properly defined.</span>
<span class="sd">     This will return a new cuboid that represents the stack, with a new &#39;interface&lt;i&gt;&#39; surface group.</span>

<span class="sd">    Limitations:</span>
<span class="sd">        - Requires cuboids with the same shape except along the stack axis.</span>
<span class="sd">        - Cannot stack another stack unless it is along its stacked axis (ill-defined interface material).</span>
<span class="sd">        - Expected behavior not guaranteed for pre-rotated cuboids.</span>
<span class="sd">        - Stacked cuboids will lose reference to their initial stack surface (not a closed solid anymore).</span>
<span class="sd">            Use the returned cuboid stack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stacker</span> <span class="o">=</span> <span class="n">CuboidStacker</span><span class="p">()</span>
    <span class="n">stackResult</span> <span class="o">=</span> <span class="n">stacker</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">onCuboid</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">otherCuboid</span><span class="o">=</span><span class="n">other</span><span class="p">,</span> <span class="n">onSurface</span><span class="o">=</span><span class="n">onSurface</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Cuboid</span><span class="o">.</span><span class="n">_fromStackResult</span><span class="p">(</span><span class="n">stackResult</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">stackLabel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Cylinder" class="doc doc-heading">
            <code>Cylinder</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pytissueoptics.scene.solids.solid.Solid">Solid</span></code></p>









              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/solids/cylinder.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Cylinder</span><span class="p">(</span><span class="n">Solid</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">u</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
        <span class="n">v</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cylinder&quot;</span><span class="p">,</span>
        <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default cylinder orientation will be along the z axis. The front face towards the negative z axis and the back</span>
<span class="sd">        face towards the positive z axis. Position refers to its centroid. Available surfaces are &quot;front&quot;, &quot;lateral&quot; and</span>
<span class="sd">        &quot;back&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="k">if</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;u must be &gt;= 3&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;v must be &gt;= 1 for non-zero length&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">radius</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">length</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_u</span> <span class="o">=</span> <span class="n">u</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_v</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_minRadius</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angularStep</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lateralStep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radialStep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="n">primitive</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="p">[],</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translateBy</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">+=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span>
        <span class="n">direction</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">direction</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeTriangleMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">frontLayers</span><span class="p">,</span> <span class="n">lateralLayers</span><span class="p">,</span> <span class="n">backLayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeVerticesOfLayers</span><span class="p">()</span>

        <span class="n">frontLayers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span><span class="p">])</span>
        <span class="n">frontLayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lateralLayers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">backLayers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lateralLayers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">backLayers</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;front&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getSurfaceTriangles</span><span class="p">(</span><span class="n">frontLayers</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;lateral&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getSurfaceTriangles</span><span class="p">(</span><span class="n">lateralLayers</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;back&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getSurfaceTriangles</span><span class="p">(</span><span class="n">backLayers</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeVerticesOfLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">frontLayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSectionVertices</span><span class="p">(</span><span class="n">lateralSteps</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">radialSteps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">)))</span>
        <span class="n">lateralLayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSectionVertices</span><span class="p">(</span><span class="n">lateralSteps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">radialSteps</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">])</span>
        <span class="n">backLayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSectionVertices</span><span class="p">(</span><span class="n">lateralSteps</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">radialSteps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">frontLayers</span><span class="p">,</span> <span class="n">lateralLayers</span><span class="p">,</span> <span class="n">backLayers</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeSectionVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lateralSteps</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">radialSteps</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
        <span class="n">verticesLayers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">radialSteps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lateralSteps</span><span class="p">:</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">):</span>
                    <span class="n">layer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_createVertex</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
                <span class="n">verticesLayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">verticesLayers</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_createVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vertex</span><span class="p">:</span>
        <span class="n">shrinkFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getShrinkFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lateralStep</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">radiusFactor</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radialStep</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>
        <span class="k">if</span> <span class="n">shrinkFactor</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># This is for cones only. In this case we want to keep linear sampling of radius values.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For lenses, we usually want a uniform mesh after the curve transform, but this transform tends to push</span>
            <span class="c1"># vertices outwards (particularly at low radius). To prevent a low mesh resolution in the center, we need</span>
            <span class="c1"># to increase the sampling around the center beforehand by forcing smaller radiusFactor values.</span>
            <span class="n">radiusFactor</span> <span class="o">=</span> <span class="n">radiusFactor</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">*</span> <span class="n">radiusFactor</span> <span class="o">*</span> <span class="n">shrinkFactor</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angularStep</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angularStep</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lateralStep</span>
        <span class="k">return</span> <span class="n">Vertex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getSurfaceTriangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verticesLayers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Triangle</span><span class="p">]:</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">verticesLayers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">currentGroup</span> <span class="o">=</span> <span class="n">verticesLayers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nextGroup</span> <span class="o">=</span> <span class="n">verticesLayers</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">currentGroup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">triangles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_getPeakTriangles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span><span class="p">,</span> <span class="n">nextGroup</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nextGroup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">triangles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_getPeakTriangles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="p">,</span> <span class="n">currentGroup</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">):</span>
                <span class="n">nextIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span>
                <span class="n">triangles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">currentGroup</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nextGroup</span><span class="p">[</span><span class="n">nextIndex</span><span class="p">],</span> <span class="n">nextGroup</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">triangles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">currentGroup</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">currentGroup</span><span class="p">[</span><span class="n">nextIndex</span><span class="p">],</span> <span class="n">nextGroup</span><span class="p">[</span><span class="n">nextIndex</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">triangles</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getPeakTriangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peakVertex</span><span class="p">:</span> <span class="n">Vertex</span><span class="p">,</span> <span class="n">ringVertices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vertex</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Triangle</span><span class="p">]:</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">):</span>
            <span class="n">nextIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span>
            <span class="n">triangles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">peakVertex</span><span class="p">,</span> <span class="n">ringVertices</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ringVertices</span><span class="p">[</span><span class="n">nextIndex</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">triangles</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeQuadMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Quad mesh not implemented for Cylinder&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">vertices</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span>
        <span class="n">basePosition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">-</span> <span class="n">direction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="n">localPoint</span> <span class="o">=</span> <span class="n">vertex</span> <span class="o">-</span> <span class="n">basePosition</span>
            <span class="n">alongCylinder</span> <span class="o">=</span> <span class="n">direction</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">localPoint</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alongCylinder</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alongCylinder</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">radiusCheck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minRadiusAtHeightAlong</span><span class="p">(</span><span class="n">alongCylinder</span><span class="p">)</span>
            <span class="n">radialComponent</span> <span class="o">=</span> <span class="n">localPoint</span> <span class="o">-</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">alongCylinder</span>
            <span class="n">radialDistanceFromBase</span> <span class="o">=</span> <span class="n">radialComponent</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">radialDistanceFromBase</span> <span class="o">&gt;</span> <span class="n">radiusCheck</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_minRadiusAtHeightAlong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heightAlong</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">shrinkFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getShrinkFactor</span><span class="p">(</span><span class="n">heightAlong</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minRadius</span> <span class="o">*</span> <span class="n">shrinkFactor</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_getShrinkFactor</span><span class="p">(</span><span class="n">heightAlong</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surfaceLabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Smoothing a cylinder with less than 16 sides (u &lt; 16) may result in intersection errors.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">surfaceLabel</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Cylinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">,</span> <span class="n">reset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="s2">&quot;lateral&quot;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">materialHash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_material</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_material</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">propertyHash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="n">materialHash</span><span class="p">,</span> <span class="n">propertyHash</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_geometryParams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span><span class="p">,</span>
            <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span><span class="p">,</span>
            <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">,</span>
            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span><span class="p">,</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Cylinder.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cylinder&#39;</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Default cylinder orientation will be along the z axis. The front face towards the negative z axis and the back
face towards the positive z axis. Position refers to its centroid. Available surfaces are "front", "lateral" and
"back".</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/solids/cylinder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">u</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
    <span class="n">v</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cylinder&quot;</span><span class="p">,</span>
    <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Default cylinder orientation will be along the z axis. The front face towards the negative z axis and the back</span>
<span class="sd">    face towards the positive z axis. Position refers to its centroid. Available surfaces are &quot;front&quot;, &quot;lateral&quot; and</span>
<span class="sd">    &quot;back&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="n">length</span>
    <span class="k">if</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;u must be &gt;= 3&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">length</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;v must be &gt;= 1 for non-zero length&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">radius</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">length</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_u</span> <span class="o">=</span> <span class="n">u</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_v</span> <span class="o">=</span> <span class="n">v</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_s</span> <span class="o">=</span> <span class="n">s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_minRadius</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_angularStep</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lateralStep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_radialStep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="n">primitive</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="p">[],</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">translateBy</span><span class="p">(</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">+=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Ellipsoid" class="doc doc-heading">
            <code>Ellipsoid</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pytissueoptics.scene.solids.solid.Solid">Solid</span></code></p>


        <p>We take the unit sphere, then calculate the theta, phi position of each vertex (with ISO mathematical
convention). Then we apply the ellipsoid formula in the spherical coordinate to isolate the component R.
We then calculate the difference the ellipsoid would with the unit sphere for this theta,phi and
then .add() or .subtract() the corresponding vector.</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/solids/ellipsoid.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Ellipsoid</span><span class="p">(</span><span class="n">Solid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We take the unit sphere, then calculate the theta, phi position of each vertex (with ISO mathematical</span>
<span class="sd">    convention). Then we apply the ellipsoid formula in the spherical coordinate to isolate the component R.</span>
<span class="sd">    We then calculate the difference the ellipsoid would with the unit sphere for this theta,phi and</span>
<span class="sd">    then .add() or .subtract() the corresponding vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ellipsoid&quot;</span><span class="p">,</span>
        <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
        <span class="n">smooth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">order</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="n">primitive</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="p">[],</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeTriangleMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The most precise sphere approximation is the IcoSphere, which is generated from the platonic solid,</span>
<span class="sd">        the Icosahedron. It is built with 20 equilateral triangles with exactly the same angle between each.</span>
<span class="sd">        From Euler&#39;s method to generate the vertex for the icosahedron, we cross 3 perpendicular planes,</span>
<span class="sd">        with length=2 and width=2*phi. Joining adjacent vertices will produce the Icosahedron.</span>

<span class="sd">        From the Icosahedron, we can split each face in 4 triangles, in a recursive manner, to obtain an IcoSphere.</span>
<span class="sd">        The method goes as follows:</span>
<span class="sd">        1 - Find each mid-point between two connecting vertices on a triangle</span>
<span class="sd">        2 - Normalize those new points to project them onto the unit sphere.</span>
<span class="sd">        3 - Connect the new vertices in a way to make 4 new triangles.</span>
<span class="sd">        4 - Do these steps for each triangle (This will lead to redundant calculation, I am aware)</span>
<span class="sd">        5 - Replace the old surfaces by the new surfaces</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_computeFirstOrderTriangleMesh</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_computeNextOrderTriangleMesh</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setVerticesPositionsFromCenter</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeFirstOrderTriangleMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">5.0</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">xyPlaneVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">yzPlaneVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">phi</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">phi</span><span class="p">)]</span>
        <span class="n">xzPlaneVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">-</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">xyPlaneVertices</span><span class="p">,</span> <span class="o">*</span><span class="n">yzPlaneVertices</span><span class="p">,</span> <span class="o">*</span><span class="n">xzPlaneVertices</span><span class="p">]</span>
        <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="s2">&quot;ellipsoid&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">11</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">9</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">9</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">11</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
                <span class="n">Triangle</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeNextOrderTriangleMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">newPolygons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verticesCache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">()):</span>
            <span class="n">ai</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createMidVertex</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">bi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createMidVertex</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createMidVertex</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">newVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ai</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="n">ci</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">newVertices</span><span class="p">):</span>
                <span class="n">vHash</span> <span class="o">=</span> <span class="n">hash2</span><span class="p">((</span><span class="n">vertex</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">vHash</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verticesCache</span><span class="p">:</span>
                    <span class="n">newVertices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verticesCache</span><span class="p">[</span><span class="n">vHash</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_verticesCache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">vHash</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_verticesCache</span><span class="p">[</span><span class="n">vHash</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertex</span>

            <span class="n">newPolygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">newPolygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">newPolygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">newPolygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">newVertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">newVertices</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_surfaces</span><span class="o">.</span><span class="n">setPolygons</span><span class="p">(</span><span class="s2">&quot;ellipsoid&quot;</span><span class="p">,</span> <span class="n">newPolygons</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_createMidVertex</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
        <span class="n">middle</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">((</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">middle</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_setVerticesPositionsFromCenter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Ellipsoid parametric equation goes as: x^2/a^2 + y^2/b^2 + z^2/c^2 =1</span>
<span class="sd">        A Sphere is just an ellipsoid with a = b = c.</span>
<span class="sd">        Bringing (x, y, z) -&gt; (theta, phi, r) we can simply take the unit sphere and stretch it,</span>
<span class="sd">        since the equation becomes as follow:</span>

<span class="sd">        r^2.cos^2(theta).sin^2(phi)/a^2 + r^2.sin^2(theta).sin^2(phi)/b^2  + r^2.cos^2(phi)/c^2 = 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">:</span>
            <span class="n">vertex</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radiusTowards</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
            <span class="n">distanceFromUnitSphere</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="mf">1.0</span>
            <span class="n">vertex</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span> <span class="o">*</span> <span class="n">distanceFromUnitSphere</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">resetNormals</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_findThetaPhi</span><span class="p">(</span><span class="n">vertex</span><span class="p">:</span> <span class="n">Vertex</span><span class="p">):</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vertex</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="k">elif</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>

            <span class="k">elif</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_radiusTowards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findThetaPhi</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="mi">1</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span><span class="o">**</span><span class="mi">2</span>
                <span class="o">+</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="o">**</span><span class="mi">2</span>
                <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="o">**</span><span class="mi">2</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeQuadMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">vertices</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Only returns true if all vertices are inside the minimum radius of the ellipsoid</span>
<span class="sd">        towards each vertex direction (more restrictive with low order ellipsoids).&quot;&quot;&quot;</span>
        <span class="n">relativeVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">relativeVertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applyInverseRotation</span><span class="p">(</span><span class="n">relativeVertices</span><span class="p">)</span>
        <span class="n">relativeVerticesArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">vertex</span><span class="o">.</span><span class="n">array</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">relativeVertices</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">relativeVertexArray</span> <span class="ow">in</span> <span class="n">relativeVerticesArray</span><span class="p">:</span>
            <span class="n">relativeVertex</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">relativeVertexArray</span><span class="p">)</span>
            <span class="n">vertexRadius</span> <span class="o">=</span> <span class="n">relativeVertex</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span>
            <span class="n">relativeVertex</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">vertexRadius</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">minRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMinimumRadiusTowards</span><span class="p">(</span><span class="n">relativeVertex</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vertexRadius</span> <span class="o">&gt;=</span> <span class="n">minRadius</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getRadiusError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">aPolygon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">centerVertex</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">aPolygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">centerVertex</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="n">centerVertex</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aPolygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">))</span>
        <span class="n">centerVertex</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>

        <span class="n">localMinimumRadius</span> <span class="o">=</span> <span class="n">centerVertex</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span>
        <span class="n">localTrueRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radiusTowards</span><span class="p">(</span><span class="n">centerVertex</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">localTrueRadius</span> <span class="o">-</span> <span class="n">localMinimumRadius</span><span class="p">)</span> <span class="o">/</span> <span class="n">localTrueRadius</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getMinimumRadiusTowards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getRadiusError</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radiusTowards</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_geometryParams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;radius_a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span><span class="p">,</span>
            <span class="s2">&quot;radius_b&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">,</span>
            <span class="s2">&quot;radius_c&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="p">,</span>
            <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Ellipsoid.contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="o">*</span><span class="n">vertices</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Only returns true if all vertices are inside the minimum radius of the ellipsoid
towards each vertex direction (more restrictive with low order ellipsoids).</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/solids/ellipsoid.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">vertices</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Only returns true if all vertices are inside the minimum radius of the ellipsoid</span>
<span class="sd">    towards each vertex direction (more restrictive with low order ellipsoids).&quot;&quot;&quot;</span>
    <span class="n">relativeVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
    <span class="n">relativeVertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applyInverseRotation</span><span class="p">(</span><span class="n">relativeVertices</span><span class="p">)</span>
    <span class="n">relativeVerticesArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">vertex</span><span class="o">.</span><span class="n">array</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">relativeVertices</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">relativeVertexArray</span> <span class="ow">in</span> <span class="n">relativeVerticesArray</span><span class="p">:</span>
        <span class="n">relativeVertex</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">relativeVertexArray</span><span class="p">)</span>
        <span class="n">vertexRadius</span> <span class="o">=</span> <span class="n">relativeVertex</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span>
        <span class="n">relativeVertex</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vertexRadius</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">minRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMinimumRadiusTowards</span><span class="p">(</span><span class="n">relativeVertex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vertexRadius</span> <span class="o">&gt;=</span> <span class="n">minRadius</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Loader" class="doc doc-heading">
            <code>Loader</code>


</h2>


    <div class="doc doc-contents ">


        <p>Base class to manage the conversion between files and Scene() or Solid() from
various types of files.</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/loader/loader.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Loader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class to manage the conversion between files and Scene() or Solid() from</span>
<span class="sd">    various types of files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fileExtension</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">showProgress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Solid</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fileExtension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFileExtension</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selectParser</span><span class="p">(</span><span class="n">showProgress</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">showProgress</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getFileExtension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_selectParser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">showProgress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fileExtension</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.obj&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">OBJParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="p">,</span> <span class="n">showProgress</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This format is not supported.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">showProgress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Solid</span><span class="p">]:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vertex</span><span class="p">(</span><span class="o">*</span><span class="n">vertex</span><span class="p">))</span>

        <span class="n">totalProgressBarLength</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">objectName</span><span class="p">,</span> <span class="n">_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">totalProgressBarLength</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_object</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">pbar</span> <span class="o">=</span> <span class="n">progressBar</span><span class="p">(</span>
            <span class="n">total</span><span class="o">=</span><span class="n">totalProgressBarLength</span><span class="p">,</span>
            <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Converting File &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;surfaces&quot;</span><span class="p">,</span>
            <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">showProgress</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">solids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">objectName</span><span class="p">,</span> <span class="n">_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">surfaces</span> <span class="o">=</span> <span class="n">SurfaceCollection</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">surfaceLabel</span><span class="p">,</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">_object</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">surfaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convertSurfaceToTriangles</span><span class="p">(</span><span class="n">surface</span><span class="p">,</span> <span class="n">vertices</span><span class="p">))</span>
                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">solids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Solid</span><span class="p">(</span>
                    <span class="n">position</span><span class="o">=</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span>
                    <span class="n">surfaces</span><span class="o">=</span><span class="n">surfaces</span><span class="p">,</span>
                    <span class="n">primitive</span><span class="o">=</span><span class="n">primitives</span><span class="o">.</span><span class="n">POLYGON</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">objectName</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">solids</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_convertSurfaceToTriangles</span><span class="p">(</span><span class="n">surface</span><span class="p">:</span> <span class="n">ParsedSurface</span><span class="p">,</span> <span class="n">vertices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vertex</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Triangle</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converting to triangles only since loaded polygons are often not planar.&quot;&quot;&quot;</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">polygonIndices</span> <span class="ow">in</span> <span class="n">surface</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
            <span class="n">polygonVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">polygonIndices</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polygonVertices</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">triangles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Triangle</span><span class="p">(</span><span class="n">polygonVertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygonVertices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">polygonVertices</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">triangles</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Logger" class="doc doc-heading">
            <code>Logger</code>


</h2>


    <div class="doc doc-contents ">









              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Logger</span><span class="p">:</span>
    <span class="n">DEFAULT_LOGGER_PATH</span> <span class="o">=</span> <span class="s2">&quot;simulation.log&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromFilepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">InteractionKey</span><span class="p">,</span> <span class="n">InteractionData</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">fromFilepath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fromFilepath</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSeenSolidLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of all solid labels that have been logged in the past</span>
<span class="sd">        even if the data was discarded.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSeenSurfaceLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of all surface labels that have been logged in the past</span>
<span class="sd">        for the given solid even if the data was discarded.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">solidLabel</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getStoredSolidLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of all solid labels that are currently stored in the logger.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getStoredSurfaceLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of all surface labels that are currently stored in the logger.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="o">==</span> <span class="n">solidLabel</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">([</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">z</span><span class="p">],</span> <span class="n">DataType</span><span class="o">.</span><span class="n">POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logDataPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">dataPoint</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">position</span><span class="o">.</span><span class="n">array</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataPoint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">dataPoint</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">DATA_POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">z</span><span class="p">],</span> <span class="n">DataType</span><span class="o">.</span><span class="n">SEGMENT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logPointArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;array&#39; must be of shape (n, 3) where the second axis is (x, y, z)&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Point array must be of shape (n, 3)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logDataPointArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;array&#39; must be of shape (n, 4) or (n, 5) where the second axis is (value, x, y, z)</span>
<span class="sd">        or (value, x, y, z, photonID). The photonID column is optional.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Data point array must be of shape (n, 4) or (n, 5)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">DATA_POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logSegmentArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;array&#39; must be of shape (n, 6) where the second axis is (x1, y1, z1, x2, y2, z2)&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Segment array must be of shape (n, 6)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">SEGMENT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_appendData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">dataType</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">InteractionKey</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validateKey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">previousData</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dataType</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">previousData</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">previousData</span> <span class="o">=</span> <span class="n">ListArrayContainer</span><span class="p">()</span>
            <span class="n">previousData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dataType</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">previousData</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">previousData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validateKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">InteractionData</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getData</span><span class="p">(</span><span class="n">DataType</span><span class="o">.</span><span class="n">POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getRawDataPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;All raw 3D data points recorded for this InteractionKey (not binned). Array of shape (n, 4) or (n, 5) where</span>
<span class="sd">        the second axis is (value, x, y, z) or (value, x, y, z, photonID) if photon IDs were logged.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getData</span><span class="p">(</span><span class="n">DataType</span><span class="o">.</span><span class="n">DATA_POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSegments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getData</span><span class="p">(</span><span class="n">DataType</span><span class="o">.</span><span class="n">SEGMENT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getData</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">dataType</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="n">TransformFn</span> <span class="o">=</span> <span class="n">_noTransform</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyExists</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">container</span><span class="p">:</span> <span class="n">ListArrayContainer</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dataType</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">transform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">container</span><span class="o">.</span><span class="n">getData</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">ListArrayContainer</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">interactionData</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">points</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ListArrayContainer</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">interactionData</span><span class="p">,</span> <span class="n">dataType</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">container</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">container</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">container</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_keyExists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStoredSolidLabels</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No data stored for solid labeled &#39;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="si">}</span><span class="s2">&#39;. Available: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">getStoredSolidLabels</span><span class="p">()</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStoredSurfaceLabels</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No data stored for surface labeled &#39;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span><span class="si">}</span><span class="s2">&#39; for solid &#39;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Available: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">getStoredSurfaceLabels</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span><span class="p">)</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_LOGGER_PATH</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No filepath specified. Saving to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">),</span> <span class="n">file</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;No logger file found at &#39;</span><span class="si">{}</span><span class="s2">&#39;. No data loaded, but it will create a new file &quot;</span>
                <span class="s2">&quot;at this location if the logger is saved later on.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hasFilePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nDataPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dataPoints</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.getRawDataPoints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getRawDataPoints</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>All raw 3D data points recorded for this InteractionKey (not binned). Array of shape (n, 4) or (n, 5) where
the second axis is (value, x, y, z) or (value, x, y, z, photonID) if photon IDs were logged.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getRawDataPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;All raw 3D data points recorded for this InteractionKey (not binned). Array of shape (n, 4) or (n, 5) where</span>
<span class="sd">    the second axis is (value, x, y, z) or (value, x, y, z, photonID) if photon IDs were logged.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getData</span><span class="p">(</span><span class="n">DataType</span><span class="o">.</span><span class="n">DATA_POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.getSeenSolidLabels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getSeenSolidLabels</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a list of all solid labels that have been logged in the past
even if the data was discarded.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getSeenSolidLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of all solid labels that have been logged in the past</span>
<span class="sd">    even if the data was discarded.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.getSeenSurfaceLabels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getSeenSurfaceLabels</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a list of all surface labels that have been logged in the past
for the given solid even if the data was discarded.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getSeenSurfaceLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of all surface labels that have been logged in the past</span>
<span class="sd">    for the given solid even if the data was discarded.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">solidLabel</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.getStoredSolidLabels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getStoredSolidLabels</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a list of all solid labels that are currently stored in the logger.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getStoredSolidLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of all solid labels that are currently stored in the logger.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.getStoredSurfaceLabels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getStoredSurfaceLabels</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a list of all surface labels that are currently stored in the logger.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">getStoredSurfaceLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of all surface labels that are currently stored in the logger.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">solidLabel</span> <span class="o">==</span> <span class="n">solidLabel</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">surfaceLabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.logDataPointArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logDataPointArray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>'array' must be of shape (n, 4) or (n, 5) where the second axis is (value, x, y, z)
or (value, x, y, z, photonID). The photonID column is optional.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">logDataPointArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&#39;array&#39; must be of shape (n, 4) or (n, 5) where the second axis is (value, x, y, z)</span>
<span class="sd">    or (value, x, y, z, photonID). The photonID column is optional.&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Data point array must be of shape (n, 4) or (n, 5)&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">DATA_POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.logPointArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logPointArray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>'array' must be of shape (n, 3) where the second axis is (x, y, z)</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">logPointArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&#39;array&#39; must be of shape (n, 3) where the second axis is (x, y, z)&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Point array must be of shape (n, 3)&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">POINT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Logger.logSegmentArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logSegmentArray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>'array' must be of shape (n, 6) where the second axis is (x1, y1, z1, x2, y2, z2)</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/logger/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">logSegmentArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InteractionKey</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&#39;array&#39; must be of shape (n, 6) where the second axis is (x1, y1, z1, x2, y2, z2)&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Segment array must be of shape (n, 6)&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_appendData</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">DataType</span><span class="o">.</span><span class="n">SEGMENT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Scene" class="doc doc-heading">
            <code>Scene</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pytissueoptics.scene.viewer.Displayable">Displayable</span></code></p>









              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/scene/scene.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Scene</span><span class="p">(</span><span class="n">Displayable</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Solid</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignoreIntersections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">worldMaterial</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Solid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreIntersections</span> <span class="o">=</span> <span class="n">ignoreIntersections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worldMaterial</span> <span class="o">=</span> <span class="n">worldMaterial</span>

        <span class="k">if</span> <span class="n">solids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="n">solids</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resetOutsideMaterial</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solid</span><span class="p">:</span> <span class="n">Solid</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
            <span class="n">solid</span><span class="o">.</span><span class="n">translateTo</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validateLabel</span><span class="p">(</span><span class="n">solid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreIntersections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validatePosition</span><span class="p">(</span><span class="n">solid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solid</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">addToViewer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">viewer</span><span class="p">:</span> <span class="n">Abstract3DViewer</span><span class="p">,</span> <span class="n">representation</span><span class="o">=</span><span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;bone&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">viewer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">solids</span><span class="p">,</span> <span class="n">representation</span><span class="o">=</span><span class="n">representation</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getWorldEnvironment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Environment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worldMaterial</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validatePosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newSolid</span><span class="p">:</span> <span class="n">Solid</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert newSolid position is valid and make proper adjustments so that the</span>
<span class="sd">        material at each solid interface is well-defined.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">intersectingSuspects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findIntersectingSuspectsFor</span><span class="p">(</span><span class="n">newSolid</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersectingSuspects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">intersectingSuspects</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()</span><span class="o">.</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()</span><span class="o">.</span><span class="n">xMin</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">otherSolid</span> <span class="ow">in</span> <span class="n">intersectingSuspects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">newSolid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="o">*</span><span class="n">otherSolid</span><span class="o">.</span><span class="n">getVertices</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_processContainedSolid</span><span class="p">(</span><span class="n">otherSolid</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="n">newSolid</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">otherSolid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="o">*</span><span class="n">newSolid</span><span class="o">.</span><span class="n">getVertices</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_processContainedSolid</span><span class="p">(</span><span class="n">newSolid</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="n">otherSolid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot place a solid that partially intersects with an existing solid. &quot;</span>
                    <span class="s2">&quot;Since this might be underestimating containment, you can also create a &quot;</span>
                    <span class="s2">&quot;scene with &#39;ignoreIntersections=True&#39; to ignore this error and manually &quot;</span>
                    <span class="s2">&quot;handle environments of contained solids with &quot;</span>
                    <span class="s2">&quot;containedSolid.setOutsideEnvironment(containerSolid.getEnvironment()).&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_processContainedSolid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solid</span><span class="p">:</span> <span class="n">Solid</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">Solid</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">container</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
            <span class="n">containerEnv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEnvironmentOfStackAt</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">containerEnv</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">()</span>
        <span class="n">solid</span><span class="o">.</span><span class="n">setOutsideEnvironment</span><span class="p">(</span><span class="n">containerEnv</span><span class="p">)</span>

        <span class="n">containerLabel</span> <span class="o">=</span> <span class="n">containerEnv</span><span class="o">.</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">containerLabel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="p">[</span><span class="n">containerLabel</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="p">[</span><span class="n">containerLabel</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validateLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solid</span><span class="p">):</span>
        <span class="n">labelSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">solids</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labelSet</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">labelSet</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;A solid with label &#39;</span><span class="si">{</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39; already exists in the scene. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Renaming to &#39;</span><span class="si">{</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="p">)</span>
        <span class="n">solid</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_findIntersectingSuspectsFor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Solid</span><span class="p">]:</span>
        <span class="n">solidBBox</span> <span class="o">=</span> <span class="n">solid</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()</span>
        <span class="n">intersectingSuspects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">otherSolid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">solidBBox</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">otherSolid</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()):</span>
                <span class="n">intersectingSuspects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">otherSolid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">intersectingSuspects</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSolids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Solid</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSolid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Solid</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">solidLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">solid</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">solid</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">layerLabel</span> <span class="ow">in</span> <span class="n">solid</span><span class="o">.</span><span class="n">getLayerLabels</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">layerLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">solidLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="k">return</span> <span class="n">solid</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solid &#39;</span><span class="si">{</span><span class="n">solidLabel</span><span class="si">}</span><span class="s2">&#39; not found in scene. Available solids: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">getSolidLabels</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSolidLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">getLayerLabels</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getSurfaceLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">solid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSolid</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">isStack</span><span class="p">()</span> <span class="ow">and</span> <span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()</span> <span class="o">!=</span> <span class="n">solidLabel</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">solid</span><span class="o">.</span><span class="n">getLayerSurfaceLabels</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">solid</span><span class="o">.</span><span class="n">surfaceLabels</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getContainedSolidLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getPolygons</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Polygon</span><span class="p">]:</span>
        <span class="n">polygons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="n">polygons</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">polygons</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getMaterials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_worldMaterial</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">isDetector</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">surfaceLabels</span> <span class="o">=</span> <span class="n">solid</span><span class="o">.</span><span class="n">surfaceLabels</span>
            <span class="k">for</span> <span class="n">surfaceLabel</span> <span class="ow">in</span> <span class="n">surfaceLabels</span><span class="p">:</span>
                <span class="n">material</span> <span class="o">=</span> <span class="n">solid</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">insideEnvironment</span><span class="o">.</span><span class="n">material</span>
                <span class="k">if</span> <span class="n">material</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">materials</span><span class="p">:</span>
                    <span class="n">materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">material</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">solid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSolid</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
            <span class="n">layerSurfaceLabel</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">solid</span><span class="o">.</span><span class="n">getLayerSurfaceLabels</span><span class="p">(</span><span class="n">solidLabel</span><span class="p">)</span> <span class="k">if</span> <span class="n">INTERFACE_KEY</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">solid</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">(</span><span class="n">layerSurfaceLabel</span><span class="p">)</span><span class="o">.</span><span class="n">material</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">solid</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">()</span><span class="o">.</span><span class="n">material</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getBoundingBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundingBox</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">bbox</span><span class="o">.</span><span class="n">extendTo</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resetOutsideMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outsideEnvironment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWorldEnvironment</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isHidden</span><span class="p">(</span><span class="n">solid</span><span class="o">.</span><span class="n">getLabel</span><span class="p">()):</span>
                <span class="k">continue</span>
            <span class="n">solid</span><span class="o">.</span><span class="n">setOutsideEnvironment</span><span class="p">(</span><span class="n">outsideEnvironment</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_isHidden</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solidLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">hiddenLabels</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">solidLabel</span> <span class="ow">in</span> <span class="n">hiddenLabels</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getEnvironmentAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
        <span class="c1"># First, recursively look if position is in a contained solid.</span>
        <span class="k">for</span> <span class="n">containerLabel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solidsContainedIn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEnvironmentOfContainerAt</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">containerLabel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">env</span>

        <span class="k">for</span> <span class="n">solid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">position</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">solid</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEnvironmentOfStackAt</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">solid</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">solid</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWorldEnvironment</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getEnvironmentOfContainerAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">containerLabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Environment</span><span class="p">]:</span>
        <span class="n">containerSolid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSolid</span><span class="p">(</span><span class="n">containerLabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">containerSolid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">position</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">containedLabel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getContainedSolidLabels</span><span class="p">(</span><span class="n">containerLabel</span><span class="p">):</span>
            <span class="n">containedEnv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEnvironmentOfContainerAt</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">containedLabel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">containedEnv</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">containedEnv</span>
        <span class="k">if</span> <span class="n">containerSolid</span><span class="o">.</span><span class="n">isStack</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEnvironmentOfStackAt</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">containerSolid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">containerSolid</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_getEnvironmentOfStackAt</span><span class="p">(</span><span class="n">position</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Solid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the environment of the stack at the given position.</span>

<span class="sd">        To do that we first find the interface in the stack that is closest to the given position.</span>
<span class="sd">        At the same time we find on which side of the interface we are and return the environment</span>
<span class="sd">        of this side from any surface polygon.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">closestDistance</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
        <span class="k">for</span> <span class="n">surfaceLabel</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">surfaceLabels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">INTERFACE_KEY</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">surfaceLabel</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">planePolygon</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">getPolygons</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">planeNormal</span> <span class="o">=</span> <span class="n">planePolygon</span><span class="o">.</span><span class="n">normal</span>
            <span class="n">planePoint</span> <span class="o">=</span> <span class="n">planePolygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">position</span> <span class="o">-</span> <span class="n">planePoint</span>
            <span class="n">distanceFromPlane</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">planeNormal</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">distanceFromPlane</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">closestDistance</span><span class="p">:</span>
                <span class="n">closestDistance</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">distanceFromPlane</span><span class="p">)</span>
                <span class="n">isInside</span> <span class="o">=</span> <span class="n">distanceFromPlane</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="n">environment</span> <span class="o">=</span> <span class="n">planePolygon</span><span class="o">.</span><span class="n">insideEnvironment</span> <span class="k">if</span> <span class="n">isInside</span> <span class="k">else</span> <span class="n">planePolygon</span><span class="o">.</span><span class="n">outsideEnvironment</span>
        <span class="k">return</span> <span class="n">environment</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">solidHash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="nb">hash</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solids</span><span class="p">])))</span>
        <span class="n">worldMaterialHash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worldMaterial</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worldMaterial</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="n">solidHash</span><span class="p">,</span> <span class="n">worldMaterialHash</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Sphere" class="doc doc-heading">
            <code>Sphere</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Ellipsoid (pytissueoptics.scene.solids.Ellipsoid)" href="#pytissueoptics.scene.Ellipsoid">Ellipsoid</a></code></p>


        <p>The Sphere is the 3D analog to the circle. Meshing a sphere requires an infinite number of vertices.
The position refers to the vector from global origin to its centroid.
The radius of the sphere will determine the outermost distance from its centroid.</p>
<p>This class offers two possible methods to generate the sphere mesh.
- With Quads: Specify the number of separation lines on the vertical axis and the horizontal axis of the sphere.
- With Triangle: Specify the order of splitting. This will generate what is known as an IcoSphere.</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/solids/sphere.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Sphere</span><span class="p">(</span><span class="n">Ellipsoid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Sphere is the 3D analog to the circle. Meshing a sphere requires an infinite number of vertices.</span>
<span class="sd">    The position refers to the vector from global origin to its centroid.</span>
<span class="sd">    The radius of the sphere will determine the outermost distance from its centroid.</span>

<span class="sd">    This class offers two possible methods to generate the sphere mesh.</span>
<span class="sd">    - With Quads: Specify the number of separation lines on the vertical axis and the horizontal axis of the sphere.</span>
<span class="sd">    - With Triangle: Specify the order of splitting. This will generate what is known as an IcoSphere.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span>
        <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
        <span class="n">smooth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">radius</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">a</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
            <span class="n">b</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">primitive</span><span class="o">=</span><span class="n">primitive</span><span class="p">,</span>
            <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeQuadMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">vertices</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Only returns true if all vertices are inside the minimum radius of the sphere</span>
<span class="sd">        (more restrictive with low order spheres).&quot;&quot;&quot;</span>
        <span class="n">minRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMinimumRadius</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="n">relativeVertex</span> <span class="o">=</span> <span class="n">vertex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
            <span class="k">if</span> <span class="n">relativeVertex</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">minRadius</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getMinimumRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getRadiusError</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_radiusTowards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_geometryParams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span><span class="p">,</span>
            <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Sphere.contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="o">*</span><span class="n">vertices</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Only returns true if all vertices are inside the minimum radius of the sphere
(more restrictive with low order spheres).</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/solids/sphere.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">vertices</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Only returns true if all vertices are inside the minimum radius of the sphere</span>
<span class="sd">    (more restrictive with low order spheres).&quot;&quot;&quot;</span>
    <span class="n">minRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMinimumRadius</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
        <span class="n">relativeVertex</span> <span class="o">=</span> <span class="n">vertex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
        <span class="k">if</span> <span class="n">relativeVertex</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">minRadius</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.SymmetricLens" class="doc doc-heading">
            <code>SymmetricLens</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ThickLens (pytissueoptics.scene.solids.lens.ThickLens)" href="#pytissueoptics.scene.ThickLens">ThickLens</a></code></p>


        <p>A symmetrical thick lens of focal length <code>f</code> in air.</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/solids/lens.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SymmetricLens</span><span class="p">(</span><span class="n">ThickLens</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A symmetrical thick lens of focal length `f` in air.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">f</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">diameter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">thickness</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">material</span><span class="p">:</span> <span class="n">RefractiveMaterial</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lens&quot;</span><span class="p">,</span>
        <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
        <span class="n">smooth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">u</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
        <span class="n">v</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># For thick lenses, the focal length is given by the lensmaker&#39;s equation:</span>
        <span class="c1"># 1/f = (n - 1) * (1/R1 - 1/R2 + (n - 1) * d / (n * R1 * R2))</span>
        <span class="c1"># with R2 = -R1, we get the following quadratic equation to solve:</span>
        <span class="c1"># 1/f = (n - 1) * (2/R - (n - 1) * d / (n * R^2))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">n</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="n">thickness</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.ThickLens" class="doc doc-heading">
            <code>ThickLens</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Cylinder (pytissueoptics.scene.solids.Cylinder)" href="#pytissueoptics.scene.Cylinder">Cylinder</a></code></p>


        <p>The Lens is defined by a front radius, a back radius, a diameter and a thickness (along its center).
A positive frontRadius means that the front surface is convex. This is reversed for the back surface.
A flat surface is obtained by setting the corresponding radius to 0 or math.inf.
The position refers to the vector from global origin to its centroid.
The generated mesh will be divided into the following subgroups: Front, Side and Back.
By default, front will point towards the negative z-axis.</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/solids/lens.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ThickLens</span><span class="p">(</span><span class="n">Cylinder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Lens is defined by a front radius, a back radius, a diameter and a thickness (along its center).</span>
<span class="sd">    A positive frontRadius means that the front surface is convex. This is reversed for the back surface.</span>
<span class="sd">    A flat surface is obtained by setting the corresponding radius to 0 or math.inf.</span>
<span class="sd">    The position refers to the vector from global origin to its centroid.</span>
<span class="sd">    The generated mesh will be divided into the following subgroups: Front, Side and Back.</span>
<span class="sd">    By default, front will point towards the negative z-axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">frontRadius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">backRadius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">diameter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">thickness</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;thick lens&quot;</span><span class="p">,</span>
        <span class="n">primitive</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">primitives</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
        <span class="n">smooth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">u</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
        <span class="n">v</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">frontRadius</span> <span class="o">=</span> <span class="n">frontRadius</span> <span class="k">if</span> <span class="n">frontRadius</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">backRadius</span> <span class="o">=</span> <span class="n">backRadius</span> <span class="k">if</span> <span class="n">backRadius</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">frontRadius</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">diameter</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Front radius must be greater than the lens radius. Front radius: </span><span class="si">{</span><span class="n">frontRadius</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;lens radius: </span><span class="si">{</span><span class="n">diameter</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">backRadius</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">diameter</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Back radius must be greater than the lens radius. Back radius: </span><span class="si">{</span><span class="n">backRadius</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;lens radius: </span><span class="si">{</span><span class="n">diameter</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_diameter</span> <span class="o">=</span> <span class="n">diameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span> <span class="o">=</span> <span class="n">frontRadius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span> <span class="o">=</span> <span class="n">backRadius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thickness</span> <span class="o">=</span> <span class="n">thickness</span>

        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeEdgeThickness</span><span class="p">(</span><span class="n">thickness</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">radius</span><span class="o">=</span><span class="n">diameter</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
            <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">primitive</span><span class="o">=</span><span class="n">primitive</span><span class="p">,</span>
            <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_hasFrontCurvature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span> <span class="o">!=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_hasBackCurvature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span> <span class="o">!=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeEdgeThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centerThickness</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the thickness of the lens on its side. This is the length required to build the base cylinder</span>
<span class="sd">        before applying surface curvature.&quot;&quot;&quot;</span>
        <span class="n">dt1</span><span class="p">,</span> <span class="n">dt2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasFrontCurvature</span><span class="p">:</span>
            <span class="n">dt1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diameter</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">dt1</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasBackCurvature</span><span class="p">:</span>
            <span class="n">dt2</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diameter</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">dt2</span> <span class="o">*=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span><span class="p">)</span>
        <span class="n">edgeThickness</span> <span class="o">=</span> <span class="n">centerThickness</span> <span class="o">-</span> <span class="n">dt1</span> <span class="o">-</span> <span class="n">dt2</span>
        <span class="k">if</span> <span class="n">edgeThickness</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Desired center thickness is too small for the given radii and diameter.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">edgeThickness</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">centerThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="p">)</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edgeThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">frontRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">backRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">focalLength</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the focal length of the lens in air. Requires a refractive material to be defined.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_material</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_material</span><span class="p">),</span> <span class="n">RefractiveMaterial</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot compute focal length without refractive material defined.&quot;</span><span class="p">)</span>
        <span class="c1"># For thick lenses, the focal length is given by the lensmaker&#39;s equation:</span>
        <span class="c1"># 1/f = (n - 1) * (1/R1 - 1/R2 + (n - 1) * d / (n * R1 * R2))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_material</span><span class="o">.</span><span class="n">n</span>
        <span class="n">R1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span>
        <span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centerThickness</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasFrontCurvature</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasBackCurvature</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">R1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">R2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">R1</span> <span class="o">*</span> <span class="n">R2</span><span class="p">)))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasFrontCurvature</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">R1</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasBackCurvature</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">R2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_computeVerticesOfLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">frontLayers</span><span class="p">,</span> <span class="n">lateralLayers</span><span class="p">,</span> <span class="n">backLayers</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_computeVerticesOfLayers</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasFrontCurvature</span><span class="p">:</span>
            <span class="n">frontVertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">frontLayers</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_applyCurvature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span><span class="p">,</span> <span class="n">frontVertices</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasBackCurvature</span><span class="p">:</span>
            <span class="n">backVertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">backLayers</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_applyCurvature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span><span class="p">,</span> <span class="n">backVertices</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontCenter</span><span class="o">.</span><span class="n">z</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backCenter</span><span class="o">.</span><span class="n">z</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid lens: curved surfaces intersect.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frontLayers</span><span class="p">,</span> <span class="n">lateralLayers</span><span class="p">,</span> <span class="n">backLayers</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_applyCurvature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">vertices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]):</span>
        <span class="c1"># At this point, all vertices are on the same z plane.</span>
        <span class="n">surfaceZ</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">z</span>
        <span class="c1"># The sphere origin is simply found by setting the z coordinate so that the distance to</span>
        <span class="c1"># the surface perimeter equals the desired radius.</span>
        <span class="n">sphereOrigin</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">surfaceZ</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">radius</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="n">vertex</span> <span class="o">-</span> <span class="n">sphereOrigin</span>
            <span class="n">direction</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
            <span class="n">vertex</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">sphereOrigin</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">radius</span><span class="p">))</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surfaceLabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">surfaceLabel</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Cylinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">,</span> <span class="n">reset</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">surfaceLabel</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;front&quot;</span><span class="p">,</span> <span class="s2">&quot;back&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">surfaceLabel</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_geometryParams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;diameter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diameter</span><span class="p">,</span>
            <span class="s2">&quot;frontRadius&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontRadius</span><span class="p">,</span>
            <span class="s2">&quot;backRadius&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backRadius</span><span class="p">,</span>
            <span class="s2">&quot;thickness&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thickness</span><span class="p">,</span>
            <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span><span class="p">,</span>
            <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_u</span><span class="p">,</span>
            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span><span class="p">,</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_s</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pytissueoptics.scene.ThickLens.focalLength" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">focalLength</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the focal length of the lens in air. Requires a refractive material to be defined.</p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pytissueoptics.scene.Vector" class="doc doc-heading">
            <code>Vector</code>


</h2>


    <div class="doc doc-contents ">


        <p>Basic implementation of a mutable 3D Vector. It implements most of the basic vector operation.
Mutability is necessary when working with shared object references for expected behavior.</p>








              <details class="quote">
                <summary>Source code in <code>pytissueoptics/scene/geometry/vector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Vector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Basic implementation of a mutable 3D Vector. It implements most of the basic vector operation.</span>
<span class="sd">    Mutability is necessary when working with shared object references for expected behavior.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="n">z</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Vector&gt;:(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">):</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">_z</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">_z</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">*</span> <span class="n">scalar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">*</span> <span class="n">scalar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">*</span> <span class="n">scalar</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">/</span> <span class="n">scalar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">/</span> <span class="n">scalar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">/</span> <span class="n">scalar</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">_z</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">-=</span> <span class="n">other</span><span class="o">.</span><span class="n">_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-=</span> <span class="n">other</span><span class="o">.</span><span class="n">_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">-=</span> <span class="n">other</span><span class="o">.</span><span class="n">_z</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">*=</span> <span class="n">scalar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">*=</span> <span class="n">scalar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">*=</span> <span class="n">scalar</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">/=</span> <span class="n">scalar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">/=</span> <span class="n">scalar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">/=</span> <span class="n">scalar</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getNorm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNorm</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">norm</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">/</span> <span class="n">norm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">/</span> <span class="n">norm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">/</span> <span class="n">norm</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cross</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">,</span> <span class="n">uz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>
        <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_z</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="n">uy</span> <span class="o">*</span> <span class="n">vz</span> <span class="o">-</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">vy</span><span class="p">,</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">vx</span> <span class="o">-</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">vz</span><span class="p">,</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">vy</span> <span class="o">-</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">vx</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">_z</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="n">z</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rotateAround</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitAxis</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotate the vector around `unitAxis` by `theta` radians. Assumes the axis to be a unit vector.</span>
<span class="sd">        Uses Rodrigues&#39; rotation formula.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This is the most expensive (and most common)</span>
        <span class="c1"># operation when performing Monte Carlo in tissue</span>
        <span class="c1"># (15% of time spent here). It is difficult to optimize without</span>
        <span class="c1"># making it even less readable than it currently is</span>
        <span class="c1"># http://en.wikipedia.org/wiki/Rotation_matrix</span>
        <span class="c1">#</span>
        <span class="c1"># Several options were tried in the past such as</span>
        <span class="c1"># external not-so-portable C library, unreadable</span>
        <span class="c1"># shortcuts, sine and cosine lookup tables, etc...</span>
        <span class="c1"># and the performance gain was minimal (&lt;20%).</span>
        <span class="c1"># For now, this is the best, most readable solution.</span>

        <span class="n">cost</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">sint</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">one_cost</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">cost</span>

        <span class="n">ux</span> <span class="o">=</span> <span class="n">unitAxis</span><span class="o">.</span><span class="n">x</span>
        <span class="n">uy</span> <span class="o">=</span> <span class="n">unitAxis</span><span class="o">.</span><span class="n">y</span>
        <span class="n">uz</span> <span class="o">=</span> <span class="n">unitAxis</span><span class="o">.</span><span class="n">z</span>

        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>

        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">cost</span> <span class="o">+</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">one_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">ux</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">-</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">ux</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span>
        <span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">uy</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">+</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">cost</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">one_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">uy</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">-</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span>
        <span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">uz</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">-</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">uz</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">+</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">cost</span> <span class="o">+</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">one_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getAnyOrthogonal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Vector&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pytissueoptics.scene.Vector.rotateAround" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rotateAround</span><span class="p">(</span><span class="n">unitAxis</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rotate the vector around <code>unitAxis</code> by <code>theta</code> radians. Assumes the axis to be a unit vector.
Uses Rodrigues' rotation formula.</p>


            <details class="quote">
              <summary>Source code in <code>pytissueoptics/scene/geometry/vector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rotateAround</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitAxis</span><span class="p">:</span> <span class="s2">&quot;Vector&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotate the vector around `unitAxis` by `theta` radians. Assumes the axis to be a unit vector.</span>
<span class="sd">    Uses Rodrigues&#39; rotation formula.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This is the most expensive (and most common)</span>
    <span class="c1"># operation when performing Monte Carlo in tissue</span>
    <span class="c1"># (15% of time spent here). It is difficult to optimize without</span>
    <span class="c1"># making it even less readable than it currently is</span>
    <span class="c1"># http://en.wikipedia.org/wiki/Rotation_matrix</span>
    <span class="c1">#</span>
    <span class="c1"># Several options were tried in the past such as</span>
    <span class="c1"># external not-so-portable C library, unreadable</span>
    <span class="c1"># shortcuts, sine and cosine lookup tables, etc...</span>
    <span class="c1"># and the performance gain was minimal (&lt;20%).</span>
    <span class="c1"># For now, this is the best, most readable solution.</span>

    <span class="n">cost</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">sint</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">one_cost</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">cost</span>

    <span class="n">ux</span> <span class="o">=</span> <span class="n">unitAxis</span><span class="o">.</span><span class="n">x</span>
    <span class="n">uy</span> <span class="o">=</span> <span class="n">unitAxis</span><span class="o">.</span><span class="n">y</span>
    <span class="n">uz</span> <span class="o">=</span> <span class="n">unitAxis</span><span class="o">.</span><span class="n">z</span>

    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">cost</span> <span class="o">+</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">one_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">ux</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">-</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">ux</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span>
    <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">uy</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">+</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">cost</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">one_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">uy</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">-</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span>
    <span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">uz</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">-</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">uz</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">one_cost</span> <span class="o">+</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">sint</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">cost</span> <span class="o">+</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">one_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>